[
  {
    "question": "What is the total gross revenue in USD?",
    "answer": "The total gross revenue in USD is calculated by summing the price_usd column from the orders table.",
    "sql_query": "SELECT SUM(price_usd) AS gross_revenue_usd FROM orders;",
    "metadata": {
      "tables": [
        "orders"
      ],
      "columns": [
        "price_usd"
      ],
      "category": "Revenue",
      "grain": "overall",
      "metric_id": "gross_revenue_usd"
    }
  },
  {
    "question": "Show me the overall gross revenue (USD).",
    "answer": "The overall gross revenue in USD is the sum of all order prices.",
    "sql_query": "SELECT SUM(price_usd) AS gross_revenue_usd FROM orders;",
    "metadata": {
      "tables": [
        "orders"
      ],
      "columns": [
        "price_usd"
      ],
      "category": "Revenue",
      "grain": "overall",
      "metric_id": "gross_revenue_usd"
    }
  },
  {
    "question": "How much revenue have we generated in USD?",
    "answer": "Revenue generated in USD equals the total of the price_usd column from orders.",
    "sql_query": "SELECT SUM(price_usd) AS gross_revenue_usd FROM orders;",
    "metadata": {
      "tables": [
        "orders"
      ],
      "columns": [
        "price_usd"
      ],
      "category": "Revenue",
      "grain": "overall",
      "metric_id": "gross_revenue_usd"
    }
  },
  {
    "question": "Give me the sum of order prices in USD.",
    "answer": "Sum of order prices in USD is obtained by aggregating price_usd from orders.",
    "sql_query": "SELECT SUM(price_usd) AS gross_revenue_usd FROM orders;",
    "metadata": {
      "tables": [
        "orders"
      ],
      "columns": [
        "price_usd"
      ],
      "category": "Revenue",
      "grain": "overall",
      "metric_id": "gross_revenue_usd"
    }
  },
  {
    "question": "What is our net revenue in USD after refunds?",
    "answer": "Net revenue in USD equals total order revenue minus total refunds.",
    "sql_query": "SELECT (SELECT SUM(o.price_usd) FROM orders o) - (SELECT SUM(r.refund_amount_usd) FROM refunds r) AS net_revenue_usd;",
    "metadata": {
      "tables": [
        "orders",
        "refunds"
      ],
      "columns": [
        "orders.price_usd",
        "refunds.refund_amount_usd"
      ],
      "category": "Revenue",
      "grain": "overall",
      "metric_id": "net_revenue_usd"
    }
  },
  {
    "question": "Calculate net revenue (USD) after accounting for refunds.",
    "answer": "Net revenue (USD) is total order price_usd minus total refund_amount_usd.",
    "sql_query": "SELECT (SELECT SUM(o.price_usd) FROM orders o) - (SELECT SUM(r.refund_amount_usd) FROM refunds r) AS net_revenue_usd;",
    "metadata": {
      "tables": [
        "orders",
        "refunds"
      ],
      "columns": [
        "orders.price_usd",
        "refunds.refund_amount_usd"
      ],
      "category": "Revenue",
      "grain": "overall",
      "metric_id": "net_revenue_usd"
    }
  },
  {
    "question": "How much net revenue have we earned after refunds, in USD?",
    "answer": "Net revenue after refunds is computed by subtracting total refunds from total order revenue.",
    "sql_query": "SELECT (SELECT SUM(o.price_usd) FROM orders o) - (SELECT SUM(r.refund_amount_usd) FROM refunds r) AS net_revenue_usd;",
    "metadata": {
      "tables": [
        "orders",
        "refunds"
      ],
      "columns": [
        "orders.price_usd",
        "refunds.refund_amount_usd"
      ],
      "category": "Revenue",
      "grain": "overall",
      "metric_id": "net_revenue_usd"
    }
  },
  {
    "question": "Show revenue by device type.",
    "answer": "Revenue broken down by device type is summed from orders linked to sessions.",
    "sql_query": "SELECT s.device_type, SUM(o.price_usd) AS revenue_usd FROM orders o JOIN sessions s ON o.session_id = s.session_id GROUP BY s.device_type;",
    "metadata": {
      "tables": [
        "orders",
        "sessions"
      ],
      "columns": [
        "orders.price_usd",
        "sessions.device_type"
      ],
      "category": "Revenue",
      "grain": "device_type",
      "metric_id": "revenue_by_device_usd"
    }
  },
  {
    "question": "What revenue do we get from each device type?",
    "answer": "Revenue per device type is calculated by joining orders with sessions and aggregating price_usd.",
    "sql_query": "SELECT s.device_type, SUM(o.price_usd) AS revenue_usd FROM orders o JOIN sessions s ON o.session_id = s.session_id GROUP BY s.device_type;",
    "metadata": {
      "tables": [
        "orders",
        "sessions"
      ],
      "columns": [
        "orders.price_usd",
        "sessions.device_type"
      ],
      "category": "Revenue",
      "grain": "device_type",
      "metric_id": "revenue_by_device_usd"
    }
  },
  {
    "question": "Give me revenue split by device type (USD).",
    "answer": "Revenue split by device type is derived from the sum of order prices per device.",
    "sql_query": "SELECT s.device_type, SUM(o.price_usd) AS revenue_usd FROM orders o JOIN sessions s ON o.session_id = s.session_id GROUP BY s.device_type;",
    "metadata": {
      "tables": [
        "orders",
        "sessions"
      ],
      "columns": [
        "orders.price_usd",
        "sessions.device_type"
      ],
      "category": "Revenue",
      "grain": "device_type",
      "metric_id": "revenue_by_device_usd"
    }
  },
  {
    "question": "Daily count of orders.",
    "answer": "The number of orders per day is obtained by grouping orders by the date part of created_at.",
    "sql_query": "SELECT CAST(o.created_at AS DATE) AS order_date, COUNT(*) AS orders_count FROM orders o GROUP BY CAST(o.created_at AS DATE) ORDER BY order_date;",
    "metadata": {
      "tables": [
        "orders"
      ],
      "columns": [
        "created_at"
      ],
      "category": "Orders",
      "grain": "day",
      "metric_id": "daily_order_count"
    }
  },
  {
    "question": "How many orders do we have each day?",
    "answer": "Orders per day are counted by grouping on the date of the order's creation.",
    "sql_query": "SELECT CAST(o.created_at AS DATE) AS order_date, COUNT(*) AS orders_count FROM orders o GROUP BY CAST(o.created_at AS DATE) ORDER BY order_date;",
    "metadata": {
      "tables": [
        "orders"
      ],
      "columns": [
        "created_at"
      ],
      "category": "Orders",
      "grain": "day",
      "metric_id": "daily_order_count"
    }
  },
  {
    "question": "Show the number of orders placed per day.",
    "answer": "Number of orders per day is calculated using COUNT(*) grouped by order date.",
    "sql_query": "SELECT CAST(o.created_at AS DATE) AS order_date, COUNT(*) AS orders_count FROM orders o GROUP BY CAST(o.created_at AS DATE) ORDER BY order_date;",
    "metadata": {
      "tables": [
        "orders"
      ],
      "columns": [
        "created_at"
      ],
      "category": "Orders",
      "grain": "day",
      "metric_id": "daily_order_count"
    }
  },
  {
    "question": "List the top 5 products by units sold.",
    "answer": "Top 5 products are determined by counting order_items per product and ordering descending.",
    "sql_query": "SELECT p.product_name, COUNT(oi.order_item_id) AS units_sold FROM order_items oi JOIN products p ON oi.product_id = p.product_id GROUP BY p.product_name ORDER BY units_sold DESC OFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY;",
    "metadata": {
      "tables": [
        "order_items",
        "products"
      ],
      "columns": [
        "order_items.order_item_id",
        "order_items.product_id",
        "products.product_name"
      ],
      "category": "Product",
      "grain": "product",
      "metric_id": "top5_products_by_units"
    }
  },
  {
    "question": "What are the five best\u2011selling products by quantity?",
    "answer": "The five best\u2011selling products are identified by the highest count of order items.",
    "sql_query": "SELECT p.product_name, COUNT(oi.order_item_id) AS units_sold FROM order_items oi JOIN products p ON oi.product_id = p.product_id GROUP BY p.product_name ORDER BY units_sold DESC OFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY;",
    "metadata": {
      "tables": [
        "order_items",
        "products"
      ],
      "columns": [
        "order_items.order_item_id",
        "order_items.product_id",
        "products.product_name"
      ],
      "category": "Product",
      "grain": "product",
      "metric_id": "top5_products_by_units"
    }
  },
  {
    "question": "Give me the five products with the highest units sold.",
    "answer": "Five products with highest units sold are retrieved by aggregating order_items per product.",
    "sql_query": "SELECT p.product_name, COUNT(oi.order_item_id) AS units_sold FROM order_items oi JOIN products p ON oi.product_id = p.product_id GROUP BY p.product_name ORDER BY units_sold DESC OFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY;",
    "metadata": {
      "tables": [
        "order_items",
        "products"
      ],
      "columns": [
        "order_items.order_item_id",
        "order_items.product_id",
        "products.product_name"
      ],
      "category": "Product",
      "grain": "product",
      "metric_id": "top5_products_by_units"
    }
  }
]